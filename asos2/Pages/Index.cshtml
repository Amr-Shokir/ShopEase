@page
@model IsisStore.Pages.IndexModel
@{
    ViewData["Title"] = "Home";
}

<div class="sub-header">
    @if (string.IsNullOrEmpty(Model.Category))
    {
        <h2>All Products</h2>
    }
    else
    {
        <h2>@Model.Category.Replace("_", " ")</h2>
    }
</div>

<div class="product-grid">
    @foreach (var item in Model.Products)
    {
        <div class="product-card">
            <a href="/Details?id=@item.ProductID" class="product-image-container">
                <img src="@Model.GetWebImage(item.CoverImageURL)" alt="@item.Name" class="product-image" />
            </a>

            <div class="product-details">
                <div>
                    <span class="product-category">@item.Category?.Replace("_", " ")</span>

                    <a href="/Details?id=@item.ProductID" class="product-name" title="@item.Name">
                        @item.Name
                    </a>
                </div>

                <div class="card-bottom-row">
                    <div class="price-container">
                        @if (item.DiscountPrice != null)
                        {
                            <span class="original-price">$@item.Price</span>
                            <span class="discount-price">$@item.DiscountPrice</span>
                        }
                        else
                        {
                            <span class="current-price">$@item.Price</span>
                        }
                    </div>

                    <form method="post" asp-page-handler="AddToCart" asp-route-productId="@item.ProductID">
                        <input type="hidden" name="Category" value="@Model.Category" />
                        <input type="hidden" name="SearchString" value="@Model.SearchString" />
                        <input type="hidden" name="CurrentPage" value="@Model.CurrentPage" />

                        <button type="submit" class="aesthetic-cart-btn" title="Add to Bag">
                            <i class="fa-solid fa-bag-shopping"></i>
                        </button>
                    </form>
                </div>
            </div>
        </div>
    }
</div>

<div style="display: flex; justify-content: center; gap: 10px; margin: 40px 0;">
    @if (Model.CurrentPage > 1)
    {
        <a asp-page="./Index"
           asp-route-CurrentPage="@(Model.CurrentPage - 1)"
           asp-route-Category="@Model.Category"
           asp-route-SearchString="@Model.SearchString"
           style="padding: 10px 20px; background: #000; color: #fff; font-size: 14px; text-transform:uppercase; font-weight:bold;">Previous</a>
    }

    <span style="padding: 10px 15px; border: 1px solid #ddd; font-weight:bold;">Page @Model.CurrentPage of @Model.TotalPages</span>

    @if (Model.CurrentPage < Model.TotalPages)
    {
        <a asp-page="./Index"
           asp-route-CurrentPage="@(Model.CurrentPage + 1)"
           asp-route-Category="@Model.Category"
           asp-route-SearchString="@Model.SearchString"
           style="padding: 10px 20px; background: #d01345; color: #fff; font-size: 14px; text-transform:uppercase; font-weight:bold;">Next</a>
    }
</div>